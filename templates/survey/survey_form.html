{% extends 'base.html' %}
{% load crispy_forms_tags %}

{% block title %}SNS마케팅 건강 진단표_N플레이스{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-10">
        <div class="card shadow">
            <div class="card-header bg-primary text-white">
                <h2 class="mb-0">
                    <i class="bi bi-shop"></i> SNS마케팅 건강 진단표_N플레이스
                </h2>
            </div>
            <div class="card-body">
                <p class="lead mb-4">
                    안녕하세요! 이 진단표는 귀하의 매장 SNS마케팅 현황을 진단하여 
                    맞춤형 컨설팅을 제공하기 위한 것입니다. 
                    <strong>모든 정보는 컨설팅 목적으로만 사용됩니다.</strong>
                </p>
                
                <div class="alert alert-info">
                    <i class="bi bi-info-circle"></i> 
                    진단 소요시간: 약 5-10분 | 
                    모든 항목을 정확히 입력해 주세요.
                </div>

                {% crispy form %}
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
$(document).ready(function() {
    // 업종 선택에 따른 기타 입력 필드 표시/숨김
    $('#id_business_type').change(function() {
        if ($(this).val() === 'other') {
            $('#business_type_other_field').show();
            $('#id_business_type_other').prop('required', true);
        } else {
            $('#business_type_other_field').hide();
            $('#id_business_type_other').prop('required', false).val('');
        }
    }).trigger('change');
    
    // 광고 체크박스에 따른 예산 필드 활성화
    $('#id_ad_naver_place').change(function() {
        $('#id_ad_naver_place_budget').prop('disabled', !this.checked);
        if (!this.checked) $('#id_ad_naver_place_budget').val('');
    }).trigger('change');
    
    $('#id_ad_naver_powerlink').change(function() {
        $('#id_ad_naver_powerlink_budget').prop('disabled', !this.checked);
        if (!this.checked) $('#id_ad_naver_powerlink_budget').val('');
    }).trigger('change');
    
    $('#id_ad_instagram_reels').change(function() {
        $('#id_ad_instagram_budget').prop('disabled', !this.checked);
        if (!this.checked) $('#id_ad_instagram_budget').val('');
    }).trigger('change');
    
    // 마케팅 대행사 이용 경험에 따른 필드 활성화
    $('#id_used_marketing_agency').change(function() {
        if (this.checked) {
            $('#agency_satisfaction_field').show();
            $('#agency_service_detail_field').show();
            $('#id_agency_satisfaction').prop('required', true);
        } else {
            $('#agency_satisfaction_field').hide();
            $('#agency_service_detail_field').hide();
            $('#id_agency_satisfaction').prop('required', false).val('');
            $('#id_agency_service_detail').val('');
        }
    }).trigger('change');
    
    // 폼 유효성 검사
    $('#survey-form').on('submit', function(e) {
        var form = this;
        if (!form.checkValidity()) {
            e.preventDefault();
            e.stopPropagation();
        }
        form.classList.add('was-validated');
    });
});
</script>
{% endblock %}